% A ConTeXt document [master document: cTests.tex]

\section[title=Conclusions]

\addDocumentDirectory{doc}

\CHeaderIncludeGuard{public}{CONTESTS_CTEST_IO}
\createCHeaderFile%
  {public}%
  {joylol/cTestIO.h}%
  {}

\CHeaderIncludeGuard{private}{CONTESTS_CTEST_IO_PRIVATE}
\createCHeaderFile%
  {private}%
  {joylol/cTestIO-private.h}%
  {}

\prependCCode{default}
\startCCode
#include <stdlib.h>
#include <stdio.h>
#include <assert.h>

#include "joylol/jInterps.h"
#include "joylol/cTestIO-private.h"
\stopCCode

\createCCodeFile%
  {default}%
  {cTestIO.c}%
  {}

\addCTestInclude{<joylol/jInterps.h>}
\addCTestInclude{<joylol/cTestIO.h>}
\addCTestInclude{<joylol/cTestIO-private.h>}
\addCTestLib{<HOME>/.joylol/joylol/jInterps}
\CTestsSetup\
\startCTest
  requireStaticallyLinkedJInterps(lstate);
  initCTestIO();
  JoyLoLInterp *jInterp = getJoyLoLInterp(lstate);
\stopCTest
\createCTestFile%
  {default}%
  {allCTests.c}%
  {}

\ensureDirectoryExists{build/joylol}

\addMainDocument{cTestIO.tex}
\addSubDocument{overview.tex} 
\addSubDocument{code.tex}
\addSubDocument{conclusion.tex} 
\addConTeXtModuleDirectory{install}

\addCTestTargets{default}

\compileLmsfile{default}

\createLmsfileFile%
  {default}%
  {lmsfile}%
  {-- A Lua Make System file}

