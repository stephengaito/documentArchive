% A ConTeXt document [master document: dictionaries.tex]

\section[title=Rotate]

\setCHeaderStream{private}

\startCHeader
extern DictObj* rotateLeft(DictObj* anAVLNode);
\stopCHeader

\startCCode
DictObj* rotateLeft(DictObj* anAVLNode) {
  DEBUG(FALSE, ">-rotateLeft %p %ld:%zu=%zu %s\n",
        anAVLNode, anAVLNode->balance, anAVLNode->height,
        deepCalculateAVLNodeHeight(anAVLNode),
        printDictionary(anAVLNode));
  assert(anAVLNode->right);

  DictObj* newRoot = anAVLNode->right;
  anAVLNode->right = newRoot->left;
  newRoot->left    = anAVLNode;

  reCalculateAVLNodeHeightBalance(anAVLNode);
  reCalculateAVLNodeHeightBalance(newRoot);

  DEBUG(FALSE, "<o-rotateLeft %p %ld:%zu=%zu %s\n",
        anAVLNode, anAVLNode->balance, anAVLNode->height,
        deepCalculateAVLNodeHeight(anAVLNode),
        printDictionary(anAVLNode));
  DEBUG(FALSE, "<n-rotateLeft %p %ld:%zu=%zu %s\n",
        newRoot, newRoot->balance, newRoot->height,
        deepCalculateAVLNodeHeight(newRoot),
        printDictionary(newRoot));
  assert(anAVLNode->height == deepCalculateAVLNodeHeight(anAVLNode));
  assert(newRoot->height == deepCalculateAVLNodeHeight(newRoot));
  return newRoot;
}
\stopCCode

\startCHeader
extern DictObj* rotateRight(DictObj* anAVLNode);
\stopCHeader

\startCCode
DictObj* rotateRight(DictObj* anAVLNode) {
  DEBUG(FALSE, ">-rotateRight %p %ld:%zu=%zu %s\n",
        anAVLNode, anAVLNode->balance, anAVLNode->height,
        deepCalculateAVLNodeHeight(anAVLNode),
        printDictionary(anAVLNode));
  assert(anAVLNode->left);

  DictObj* newRoot = anAVLNode->left;
  anAVLNode->left = newRoot->right;
  newRoot->right  = anAVLNode;

  reCalculateAVLNodeHeightBalance(anAVLNode);
  reCalculateAVLNodeHeightBalance(newRoot);

  DEBUG(FALSE, "<o-rotateRight %p %ld:%zu=%zu %s\n",
        anAVLNode, anAVLNode->balance, anAVLNode->height,
        deepCalculateAVLNodeHeight(anAVLNode),
        printDictionary(anAVLNode));
  DEBUG(FALSE, "<n-rotateRight %p %ld:%zu=%zu %s\n",
        newRoot, newRoot->balance, newRoot->height,
        deepCalculateAVLNodeHeight(newRoot),
        printDictionary(newRoot));
  assert(anAVLNode->height == deepCalculateAVLNodeHeight(anAVLNode));
  assert(newRoot->height == deepCalculateAVLNodeHeight(newRoot));
  return newRoot;
}
\stopCCode

\startCHeader
extern DictObj* rotateLeftLeft(DictObj* anAVLNode);
\stopCHeader

\startCCode
DictObj* rotateLeftLeft(DictObj* anAVLNode) {
  DEBUG(FALSE, "LL %p %s\n", anAVLNode, printDictionary(anAVLNode));
  return rotateRight(anAVLNode);
}
\stopCCode

\startCHeader
extern DictObj* rotateLeftRight(DictObj* anAVLNode);
\stopCHeader

\startCCode
DictObj* rotateLeftRight(DictObj* anAVLNode) {
  DEBUG(FALSE, "0-LR %p %s\n", anAVLNode, printDictionary(anAVLNode));
  anAVLNode->left = rotateLeft(anAVLNode->left);
  DEBUG(FALSE, "1-LR %p %s\n", anAVLNode, printDictionary(anAVLNode));
  return rotateRight(anAVLNode);
}
\stopCCode

\startCHeader
extern DictObj* rotateRightLeft(DictObj* anAVLNode);
\stopCHeader

\startCCode
DictObj* rotateRightLeft(DictObj* anAVLNode) {
  DEBUG(FALSE, "0-RL %p %s\n", anAVLNode, printDictionary(anAVLNode));
  anAVLNode->right = rotateRight(anAVLNode->right);
  DEBUG(FALSE, "1-RL %p %s\n", anAVLNode, printDictionary(anAVLNode));
  return rotateLeft(anAVLNode);
}
\stopCCode

\startCHeader
extern DictObj* rotateRightRight(DictObj* anAVLNode);
\stopCHeader

\startCCode
DictObj* rotateRightRight(DictObj* anAVLNode) {
  DEBUG(FALSE, "RR %p %s\n", anAVLNode, printDictionary(anAVLNode));
  return rotateLeft(anAVLNode);
}
\stopCCode

\setCHeaderStream{public}
