-- A Lua Make System file

c = c or {}
c.cIncs = c.cIncs or {}
tInsert(c.cIncs, tConcat({
  '-I',
  makePath{
    getEnv('HOME'),
    '.joylol',
    'include'
  }
}, ''))

c.libs = c.libs or {}
tInsert(c.libs, makePath{
  getEnv('HOME'),
  '.joylol',
  'joylol',
  'coAlgs.so'
})

lfs = require 'lfs'

lfs.mkdir('build')
lfs.mkdir('build/joylol')
lfs.mkdir('install')
lfs.mkdir('install/joylol')

require 'lms.litProgs'

litProgs.targets{
  mainDoc  = 'strings.tex',
  docFiles = {
    'overview.tex',
    'code.tex',
    'conclusion.tex',
  },
  srcFiles = {
    'joylol/strings.h',
    'joylol/strings-private.h',
    'strings.c',
  },
  buildDir  = 'build',
  docDir    = 'doc',
  moduleDir = 'install',
}

require 'lms.contests'

contests.targets{
  testExecs = {
    'allCTests',
  },
  mainDoc = 'strings.tex',
  docFiles = {
    'overview.tex',
    'code.tex',
    'conclusion.tex',
  },
  srcFiles = {
    'joylol/strings.h',
    'joylol/strings-private.h',
    'strings.c',
  },
  buildDir  = 'build',
  docDir    = 'doc',
  moduleDir = 'install',
}

require 'lms.joyLoL'

joylol.targets{
  coAlgs = {
    'strings',
  },
  srcFiles = {
    'joylol/strings.h',
    'joylol/strings-private.h',
    'strings.c',
  },
  coAlgLibs = {
  },
  buildDir = 'build',
}

target{'tests',   testTargets}

target{'doc',     docTargets}
target{'diff',    diffTargets}
target{'install', installTargets}
target{'default', buildTargets}